rules:
  - id: java-insecure-password-log
    languages: [java]
    message: "Insecure logging of password - ne loggez pas le mot de passe en clair."
    severity: ERROR
    patterns:
      - pattern: System.out.println("Password: " + $X)
      - pattern-either:
          - pattern: logger.info("Password: " + $X)
          - pattern: logger.debug("Password: " + $X)
    metadata:
      category: cryptography
      tags: [password, logging, insecure]

  - id: java-sql-injection-concat
    languages: [java]
    message: "Possible SQL injection (concatenation of untrusted input into query). Utiliser PreparedStatement."
    severity: ERROR
    pattern: |
      $RS = $ST.executeQuery("SELECT * FROM $TAB WHERE $COL = '" + $USER + "'" + $TAIL)
    metadata:
      category: injection
      tags: [sql, injection]
