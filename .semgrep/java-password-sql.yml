rules:
  - id: java-insecure-password-log
    languages: [java]
    message: "Insecure logging of password - do not log plaintext passwords."
    severity: ERROR
    pattern-either:
      - pattern: System.out.println("Password: " + $X)
      - pattern: logger.info("Password: " + $X)
      - pattern: logger.debug("Password: " + $X)
    metadata:
      category: security
      cwe: "CWE-532"
      tags: [password, logging, insecure]

  - id: java-sql-injection-concat
    languages: [java]
    message: "Possible SQL injection - concatenation in query. Use PreparedStatement."
    severity: ERROR
    pattern: |
      $RS = $ST.executeQuery("SELECT * FROM users WHERE username = '" + $USER + "'")
    metadata:
      category: injection
      cwe: "CWE-89"
      tags: [sql, injection]
